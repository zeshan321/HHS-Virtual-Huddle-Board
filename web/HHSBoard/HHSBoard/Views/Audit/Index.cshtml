
@{
    ViewData["Title"] = "Audit";
}

<script>
    var $table;

    $(function () {
        $table = $('#table');

        initTable();
    });

    function initTable() {
        $table.bootstrapTable('destroy').bootstrapTable({
            exportTypes: ['json', 'xml', 'csv', 'txt', 'sql', 'excel', 'pdf']
        });
    }
    function statusFormatter(value, row, index) {
        if (value === "Deleted") {
            return '<span class="label label-danger">' + value + '</span>';
        } else if (value === "Added") {
            return '<span class="label label-success">' + value + '</span>';
        } else if (value === "Modified") {
            return '<span class="label label-warning">' + value + '</span>';
        } else {
            return '<span class="label label-default">' + value + '</span>';
        }
    }
    function jsonFormatter(value, row, index) {
        var element = "<dl>";

        $.each(JSON.parse(value), function (key, value) {
            element = element + "<dt>" + key + "</dt>"
            element = element + "<dd>" + value + "</dd>"
        });

        return element + "</dl>";
    }
</script>

<div class="page-header">
    <h1>Audit</h1>
</div>

<table id="table"
       data-pagination="true"
       data-show-export="true"
       data-search="true"
       data-mobile-responsive="true"
       data-check-on-init="true"
       data-id-field="id",
       data-show-toggle="true"
       data-show-refresh="true"
       data-auto-refresh="true"
       data-show-fullscreen="true"
       data-side-pagination="server"
       data-url="/Audit/GetAuditData">
    <thead>
        <tr>
            <th data-field="id" data-visible="false" class="fit">ID</th>
            <th data-field="dateTime" class="fit">Date</th>
            <th data-field="state" data-formatter="statusFormatter" class="fit">State</th>
            <th data-field="tableName" class="fit">Table Name</th>
            <th data-field="username" class="fit">Username</th>
            <th data-field="keyValues" data-formatter="jsonFormatter" class="fit">Key Values</th>
            <th data-field="oldValues" data-formatter="jsonFormatter" class="fit">Old Values</th>
            <th data-field="newValues" data-formatter="jsonFormatter" class="fit">New Values</th>
        </tr>
    </thead>
</table>

