@model HHSBoard.Models.HomeViewModels.HomeIndexViewModel
@{
    ViewData["Title"] = "Home Page";
}

<script type="text/javascript">
    $(function () {
        $("#createBoardForm").submit(function (e) {
            var boardName = $("#createBoardName").val();
            var unitID = $('#createBoardUnits').find(":selected").val();
            
            $.ajax({
                type: "POST",
                url: "/Home/CreateBoard",
                data: { Name: boardName, UnitID: unitID },
                dataType: "json",
                success: function (data) {
                    $.notify({
                        message: 'Successfully created board.'
                    }, {
                            type: 'success'
                    });

                    location.reload();
                },
                error: function (data) {
                    var response = data.responseJSON;

                    $.notify({
                        message: response
                    }, {
                            type: 'danger'
                    });
                }
            });
            return false;
        });
    });
</script>

<div class="page-header">
    <h1>Boards <span class="label label-default">@Model.Boards.Count</span></h1>
</div>

<div class="row">
    @foreach (var board in Model.Boards)
    {
        <div class="col-sm-6 col-md-4">
            <div class="thumbnail">
                <div class="caption">
                    <h3 class="board-name-text">@board.Name<br /><small>@board.Unit.Name</small></h3>

                    <p><a href="#" class="btn btn-primary" role="button" data-boardID="@board.ID">View</a> <a href="#" class="btn btn-danger" role="button" data-boardID="@board.ID">Delete</a></p>
                </div>
            </div>
        </div>
    }
</div>

<!-- Modal -->
<div id="newBoardModal" class="modal fade" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->
        <form id="createBoardForm">

            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Create board</h4>
                </div>

                <div class="modal-body">
                    <div class="form-group">
                        <label for="createBoardName">Board name:</label>
                        <input type="text" class="form-control" id="createBoardName" required>
                    </div>
                    <div class="form-group">
                        <label for="createBoardUnits">Select unit:</label>
                        <select class="form-control" id="createBoardUnits" required>
                            <option></option>
                            @foreach (var unit in Model.Units)
                            {
                                <option value="@unit.ID">@unit.Name</option>
                            }
                        </select>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-primary">Create</button>
                </div>
            </div>
        </form>
    </div>
</div>

<button class="btn floating-btn" data-target="#newBoardModal" data-toggle="modal"><i class="fa fa-plus"></i></button>
